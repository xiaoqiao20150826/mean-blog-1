var app=angular.module("multiBlog",["ngMessages","ngFileUpload","ui.bootstrap","ngRoute"]);app.config(["$routeProvider","$locationProvider",function(e,l){e.when("/",{templateUrl:"/views/tpls/posts.html",controller:"IndexController"}).when("/users/login",{templateUrl:"views/tpls/login.html",controller:"LoginController"}).when("/users/reg",{templateUrl:"views/tpls/reg.html",controller:"RegController"}).otherwise({redirectTo:"/"}),l.html5Mode(!0)}]);
function WelcomeController(o){console.log(111),o.username="Conan_Z"}var app=angular.module("multiBlog");WelcomeController.$inject=["$scope"],app.controller("WelcomeController",WelcomeController);
var app=angular.module("multiBlog"),IndexController=function(o,n,t){n({method:"GET",url:"/api"}).success(function(n){o.posts=angular.forEach(angular.fromJson(n.posts),function(o){o.content=t.trustAsHtml(o.content)}),console.log(o.posts),o.title=n.title,o.users=n.users}).error(function(o){console.log(o)})};IndexController.$inject=["$scope","$http","$sce"],app.controller("IndexController",IndexController);
var app=angular.module("multiBlog"),compile=function(n){return function(t,c,e){t.$watch(function(n){return n.$eval(e.compile)},function(e){c.html(e),n(c.contents())(t)})}};app.directive("compile",compile);
var posts=angular.module("multiBlog"),PublishController=function(o,t){o.submitted=!1,o.submitForm=function(){o.publishForm.$valid?t({method:"POST",url:"/posts/publish",data:{title:o.publish.title,content:o.publish.content}}).success(function(t){t.result===!0?window.location="/":o.publishForm.content.$setValidity("confirm",!1)}).error(function(o){console.log(o)}):o.submitted=!0}},EditController=function(o,t){o.submitted=!1,o.submitForm=function(){o.editForm.$valid?t({method:"POST",url:"/posts/edit",data:{title:o.edit.title,content:o.edit.content}}).success(function(t){t.result===!0?window.location="/":o.editForm.content.$setValidity("confirm",!1)}).error(function(o){console.log(o)}):o.submitted=!0}},UploadController=function(o,t){o.$watch("files",function(){o.upload(o.files)}),o.log="",o.uploadeds=[],o.upload=function(n){if(n&&n.length)for(var e=0;e<n.length;e++){var s=n[e];t.upload({url:"/posts/upload",file:s}).progress(function(t){var n=parseInt(100*t.loaded/t.total);o.log="progress: "+n+"% "+t.config.file.name+"\n"}).success(function(t,n,e,s){o.uploadeds.push(t)})}}},UserPostController=function(o,t,n){o.currentPage=1,o.$watch("username",function(){console.log(o.username)}),t({method:"POST",url:"/posts/user/",data:{username:o.username,page:o.currentPage}}).success(function(t){o.posts=angular.forEach(angular.fromJson(t.posts),function(o){o.content=n.trustAsHtml(o.content)}),o.users=t.users,console.log(t)}).error(function(o){console.log(o)})},PostController=function(o,t,n){t({method:"GET",url:"/posts/user/:username"}).success(function(t){o.posts=angular.forEach(angular.fromJson(t.posts),function(o){o.content=n.trustAsHtml(o.content)}),o.users=t.users}).error(function(o){console.log(o)})};PublishController.$inject=["$scope","$http"],EditController.$inject=["$scope","$http"],PostController.$inject=["$scope","$http","$sce"],UserPostController.$inject=["$scope","$http","$sce"],UploadController.$inject=["$scope","Upload"],posts.controller("PublishController",PublishController),posts.controller("EditController",EditController),posts.controller("PostController",PostController),posts.controller("UploadController",UploadController),posts.controller("UserPostController",UserPostController);
var posts=angular.module("multiBlog"),ngFocus=function(){var e="ng-focused";return{restrict:"A",require:"ngModel",link:function(n,o,u,i){i.$focused=!1,o.bind("focus",function(u){i.$setValidity("confirm",!0),o.addClass(e),n.$apply(function(){i.$focused=!0})}),o.bind("blur",function(u){o.removeClass(e),n.$apply(function(){i.$focused=!1})})}}},haveValue=function(){return{restrict:"A",require:"ngModel",scope:{ngModel:"="},link:function(e,n,o,u){e.ngModel=o.haveValue}}};posts.directive("ngFocus",ngFocus),posts.directive("haveValue",haveValue);
var users=angular.module("multiBlog"),LoginController=function(o,e){o.submitted=!1,o.submitForm=function(){o.loginForm.$valid?e({method:"POST",url:"/users/login",data:{username:o.login.username,password:o.login.password}}).success(function(e){e.result===!0?window.location="/":o.loginForm.password.$setValidity("wrong",!1)}).error(function(o){console.log(o)}):o.loginForm.submitted=!0}},RegController=function(o,e){o.submitted=!1,o.submitForm=function(){o.regForm.$valid?e({method:"POST",url:"/users/reg",data:{username:o.reg.username,password:o.reg.password,email:o.reg.email}}).success(function(e){e.result===!0?window.location="/":"username"==e.reason?o.regForm.username.$setValidity("unique",!1):"email"==e.reason&&o.regForm.email.$setValidity("unique",!1)}).error(function(o){console.log(o)}):o.regForm.submitted=!0}};RegController.$inject=["$scope","$http"],LoginController.$inject=["$scope","$http"],users.controller("RegController",RegController),users.controller("LoginController",LoginController);
var users=angular.module("multiBlog"),ensureUnique=function(e){return{require:"ngModel",link:function(n,i,u,r){n.$watch(u.ngModel,function(n){n&&e({method:"POST",url:"/users/check",data:{field:u.ensureUnique,value:n}}).success(function(e){r.$setValidity("unique",e.isUnique)}).error(function(e){r.$setValidity("unique",!1)})})}}},ngFocus=function(){var e="ng-focused";return{restrict:"A",require:"ngModel",link:function(n,i,u,r){r.$focused=!1,i.bind("focus",function(u){r.$setValidity("wrong",!0),i.addClass(e),n.$apply(function(){r.$focused=!0})}),i.bind("blur",function(u){i.removeClass(e),n.$apply(function(){r.$focused=!1})})}}},confirmed=function(){return{restrict:"A",require:"ngModel",link:function(e,n,i,u){e.$watch(i.ngModel,function(n){n&&(n==e.reg.password?u.$setValidity("confirmed",!0):u.$setValidity("confirmed",!1))})}}};ensureUnique.$inject=["$http"],users.directive("ensureUnique",ensureUnique),users.directive("ngFocus",ngFocus),users.directive("confirmed",confirmed);