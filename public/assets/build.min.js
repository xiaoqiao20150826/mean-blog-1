var app=angular.module("app",[]),MyController=function(o){o.clock={now:new Date};var n=function(){o.clock.now=new Date};setInterval(function(){o.$apply(n)},1e3),n()};MyController.$inject=["$scope"],app.controller("MyController",MyController);
var users=angular.module("users",["ngMessages"]),LoginController=function(o,e){o.submitted=!1,o.submitForm=function(){o.loginForm.$valid?e({method:"POST",url:"/users/login",data:{username:o.login.username,password:o.login.password}}).success(function(e){e.result===!0?window.location="/":o.loginForm.password.$setValidity("wrong",!1)}).error(function(o){console.log(o)}):o.loginForm.submitted=!0}},RegController=function(o,e){o.submitted=!1,o.submitForm=function(){o.regForm.$valid?e({method:"POST",url:"/users/reg",data:{username:o.reg.username,password:o.reg.password,email:o.reg.email}}).success(function(e){e.result===!0?window.location="/":"username"==e.reason?o.regForm.username.$setValidity("unique",!1):"email"==e.reason&&o.regForm.email.$setValidity("unique",!1)}).error(function(o){console.log(o)}):o.regForm.submitted=!0}};RegController.$inject=["$scope","$http"],LoginController.$inject=["$scope","$http"],users.controller("RegController",RegController),users.controller("LoginController",LoginController);
var users=angular.module("users"),ensureUnique=function(e){return{require:"ngModel",link:function(n,i,u,r){n.$watch(u.ngModel,function(n){n&&e({method:"POST",url:"/users/check",data:{field:u.ensureUnique,value:n}}).success(function(e){r.$setValidity("unique",e.isUnique)}).error(function(e){r.$setValidity("unique",!1)})})}}},ngFocus=function(){var e="ng-focused";return{restrict:"A",require:"ngModel",link:function(n,i,u,r){r.$focused=!1,i.bind("focus",function(u){r.$setValidity("wrong",!0),i.addClass(e),n.$apply(function(){r.$focused=!0})}),i.bind("blur",function(u){i.removeClass(e),n.$apply(function(){r.$focused=!1})})}}},confirmed=function(){return{restrict:"A",require:"ngModel",link:function(e,n,i,u){e.$watch(i.ngModel,function(n){n&&(n==e.reg.password?u.$setValidity("confirmed",!0):u.$setValidity("confirmed",!1))})}}};ensureUnique.$inject=["$http"],users.directive("ensureUnique",ensureUnique),users.directive("ngFocus",ngFocus),users.directive("confirmed",confirmed);