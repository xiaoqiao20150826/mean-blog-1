var app=angular.module("app",[]),MyController=function(o){o.clock={now:new Date};var n=function(){o.clock.now=new Date};setInterval(function(){o.$apply(n)},1e3),n()};MyController.$inject=["$scope"],app.controller("MyController",MyController);
var posts=angular.module("posts",["ngMessages","ngFileUpload","ui.bootstrap"]),PublishController=function(o,t){o.submitted=!1,o.submitForm=function(){o.publishForm.$valid?t({method:"POST",url:"/posts/publish",data:{title:o.publish.title,content:o.publish.content}}).success(function(t){t.result===!0?window.location="/":o.publishForm.content.$setValidity("confirm",!1)}).error(function(o){console.log(o)}):o.submitted=!0}},EditController=function(o,t){o.submitted=!1,o.submitForm=function(){o.editForm.$valid?t({method:"POST",url:"/posts/edit",data:{title:o.edit.title,content:o.edit.content}}).success(function(t){t.result===!0?window.location="/":o.editForm.content.$setValidity("confirm",!1)}).error(function(o){console.log(o)}):o.submitted=!0}},UploadController=function(o,t){o.$watch("files",function(){o.upload(o.files)}),o.log="",o.uploadeds=[],o.upload=function(l){if(l&&l.length)for(var e=0;e<l.length;e++){var n=l[e];t.upload({url:"/posts/upload",file:n}).progress(function(t){var l=parseInt(100*t.loaded/t.total);o.log="progress: "+l+"% "+t.config.file.name+"\n"}).success(function(t,l,e,n){o.uploadeds.push(t)})}}},PostController=function(o,t){o.totalItems=64,o.currentPage=4,console.log(o.totalItems),o.setPage=function(t){o.currentPage=t},o.pageChanged=function(t){t({method:"GET",url:"/posts/user/:username?p="+o.currentPage}).error(function(o){console.log(o)})},o.maxSize=5,o.bigTotalItems=175,o.bigCurrentPage=1};PublishController.$inject=["$scope","$http"],EditController.$inject=["$scope","$http"],PostController.$inject=["$scope","$http"],UploadController.$inject=["$scope","Upload"],posts.controller("PublishController",PublishController),posts.controller("EditController",EditController),posts.controller("PostController",PostController),posts.controller("UploadController",UploadController);
var posts=angular.module("posts"),ngFocus=function(){var e="ng-focused";return{restrict:"A",require:"ngModel",link:function(n,o,u,s){s.$focused=!1,o.bind("focus",function(u){s.$setValidity("confirm",!0),o.addClass(e),n.$apply(function(){s.$focused=!0})}),o.bind("blur",function(u){o.removeClass(e),n.$apply(function(){s.$focused=!1})})}}},haveValue=function(){return{restrict:"A",require:"ngModel",scope:{ngModel:"="},link:function(e,n,o,u){e.ngModel=o.haveValue}}};posts.directive("ngFocus",ngFocus),posts.directive("haveValue",haveValue);
var users=angular.module("users",["ngMessages"]),LoginController=function(o,e){o.submitted=!1,o.submitForm=function(){o.loginForm.$valid?e({method:"POST",url:"/users/login",data:{username:o.login.username,password:o.login.password}}).success(function(e){e.result===!0?window.location="/":o.loginForm.password.$setValidity("wrong",!1)}).error(function(o){console.log(o)}):o.loginForm.submitted=!0}},RegController=function(o,e){o.submitted=!1,o.submitForm=function(){o.regForm.$valid?e({method:"POST",url:"/users/reg",data:{username:o.reg.username,password:o.reg.password,email:o.reg.email}}).success(function(e){e.result===!0?window.location="/":"username"==e.reason?o.regForm.username.$setValidity("unique",!1):"email"==e.reason&&o.regForm.email.$setValidity("unique",!1)}).error(function(o){console.log(o)}):o.regForm.submitted=!0}};RegController.$inject=["$scope","$http"],LoginController.$inject=["$scope","$http"],users.controller("RegController",RegController),users.controller("LoginController",LoginController);
var users=angular.module("users"),ensureUnique=function(e){return{require:"ngModel",link:function(n,i,u,r){n.$watch(u.ngModel,function(n){n&&e({method:"POST",url:"/users/check",data:{field:u.ensureUnique,value:n}}).success(function(e){r.$setValidity("unique",e.isUnique)}).error(function(e){r.$setValidity("unique",!1)})})}}},ngFocus=function(){var e="ng-focused";return{restrict:"A",require:"ngModel",link:function(n,i,u,r){r.$focused=!1,i.bind("focus",function(u){r.$setValidity("wrong",!0),i.addClass(e),n.$apply(function(){r.$focused=!0})}),i.bind("blur",function(u){i.removeClass(e),n.$apply(function(){r.$focused=!1})})}}},confirmed=function(){return{restrict:"A",require:"ngModel",link:function(e,n,i,u){e.$watch(i.ngModel,function(n){n&&(n==e.reg.password?u.$setValidity("confirmed",!0):u.$setValidity("confirmed",!1))})}}};ensureUnique.$inject=["$http"],users.directive("ensureUnique",ensureUnique),users.directive("ngFocus",ngFocus),users.directive("confirmed",confirmed);